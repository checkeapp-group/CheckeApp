{
  "version": "5",
  "dialect": "mysql",
  "id": "dcebf699-692e-4543-b404-c20eba2b8f02",
  "prevId": "6d1316bb-2f00-49f6-a897-427583bcbda1",
  "tables": {
    "account": {
      "name": "account",
      "columns": {
        "id": {
          "name": "id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "accountId": {
          "name": "accountId",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "providerId": {
          "name": "providerId",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "userId": {
          "name": "userId",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "accessToken": {
          "name": "accessToken",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "refreshToken": {
          "name": "refreshToken",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "idToken": {
          "name": "idToken",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "accessTokenExpiresAt": {
          "name": "accessTokenExpiresAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "refreshTokenExpiresAt": {
          "name": "refreshTokenExpiresAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "scope": {
          "name": "scope",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "password": {
          "name": "password",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        }
      },
      "indexes": {},
      "foreignKeys": {
        "account_userId_user_id_fk": {
          "name": "account_userId_user_id_fk",
          "tableFrom": "account",
          "tableTo": "user",
          "columnsFrom": [
            "userId"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {
        "account_id": {
          "name": "account_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "session": {
      "name": "session",
      "columns": {
        "id": {
          "name": "id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "expiresAt": {
          "name": "expiresAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "token": {
          "name": "token",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "ipAddress": {
          "name": "ipAddress",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "userAgent": {
          "name": "userAgent",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "userId": {
          "name": "userId",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        }
      },
      "indexes": {},
      "foreignKeys": {
        "session_userId_user_id_fk": {
          "name": "session_userId_user_id_fk",
          "tableFrom": "session",
          "tableTo": "user",
          "columnsFrom": [
            "userId"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {
        "session_id": {
          "name": "session_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {
        "session_token_unique": {
          "name": "session_token_unique",
          "columns": [
            "token"
          ]
        }
      },
      "checkConstraint": {}
    },
    "user": {
      "name": "user",
      "columns": {
        "id": {
          "name": "id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "('')"
        },
        "email": {
          "name": "email",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "emailVerified": {
          "name": "emailVerified",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": false
        },
        "is_verified": {
          "name": "is_verified",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": false
        },
        "is_admin": {
          "name": "is_admin",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": false
        },
        "image": {
          "name": "image",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "user_id": {
          "name": "user_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {
        "user_email_unique": {
          "name": "user_email_unique",
          "columns": [
            "email"
          ]
        }
      },
      "checkConstraint": {}
    },
    "auth_verification": {
      "name": "auth_verification",
      "columns": {
        "id": {
          "name": "id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "value": {
          "name": "value",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "expiresAt": {
          "name": "expiresAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "createdAt": {
          "name": "createdAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updatedAt": {
          "name": "updatedAt",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {
        "auth_verification_id": {
          "name": "auth_verification_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {}
    },
    "critical_questions": {
      "name": "critical_questions",
      "columns": {
        "id": {
          "name": "id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "verification_id": {
          "name": "verification_id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "question_text": {
          "name": "question_text",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "original_question": {
          "name": "original_question",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "is_edited": {
          "name": "is_edited",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": false
        },
        "order_index": {
          "name": "order_index",
          "type": "int",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {
        "idx_critical_questions_verification_id": {
          "name": "idx_critical_questions_verification_id",
          "columns": [
            "verification_id"
          ],
          "isUnique": false
        },
        "idx_critical_questions_order": {
          "name": "idx_critical_questions_order",
          "columns": [
            "verification_id",
            "order_index"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "critical_questions_verification_id_verification_id_fk": {
          "name": "critical_questions_verification_id_verification_id_fk",
          "tableFrom": "critical_questions",
          "tableTo": "verification",
          "columnsFrom": [
            "verification_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {
        "critical_questions_id": {
          "name": "critical_questions_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {
        "uk_critical_questions_verification_order": {
          "name": "uk_critical_questions_verification_order",
          "columns": [
            "verification_id",
            "order_index"
          ]
        }
      },
      "checkConstraint": {
        "chk_critical_questions_order_index": {
          "name": "chk_critical_questions_order_index",
          "value": "`critical_questions`.`order_index` >= 0"
        },
        "chk_critical_questions_text_length": {
          "name": "chk_critical_questions_text_length",
          "value": "CHAR_LENGTH(`critical_questions`.`question_text`) >= 5 AND CHAR_LENGTH(`critical_questions`.`question_text`) <= 200"
        }
      }
    },
    "final_results": {
      "name": "final_results",
      "columns": {
        "id": {
          "name": "id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "verification_id": {
          "name": "verification_id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "final_text": {
          "name": "final_text",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "image_url": {
          "name": "image_url",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "labels_json": {
          "name": "labels_json",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "citations_json": {
          "name": "citations_json",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "answers_json": {
          "name": "answers_json",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {
        "idx_final_results_verification_id": {
          "name": "idx_final_results_verification_id",
          "columns": [
            "verification_id"
          ],
          "isUnique": false
        },
        "idx_final_results_created_at": {
          "name": "idx_final_results_created_at",
          "columns": [
            "created_at"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "final_results_verification_id_verification_id_fk": {
          "name": "final_results_verification_id_verification_id_fk",
          "tableFrom": "final_results",
          "tableTo": "verification",
          "columnsFrom": [
            "verification_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {
        "final_results_id": {
          "name": "final_results_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {
        "final_results_verification_id_unique": {
          "name": "final_results_verification_id_unique",
          "columns": [
            "verification_id"
          ]
        }
      },
      "checkConstraint": {
        "chk_final_results_text_length": {
          "name": "chk_final_results_text_length",
          "value": "CHAR_LENGTH(`final_results`.`final_text`) >= 10"
        },
        "chk_final_results_labels_json": {
          "name": "chk_final_results_labels_json",
          "value": "`final_results`.`labels_json` IS NULL OR JSON_VALID(`final_results`.`labels_json`)"
        },
        "chk_final_results_citations_json": {
          "name": "chk_final_results_citations_json",
          "value": "`final_results`.`citations_json` IS NULL OR JSON_VALID(`final_results`.`citations_json`)"
        },
        "chk_final_results_answers_json": {
          "name": "chk_final_results_answers_json",
          "value": "`final_results`.`answers_json` IS NULL OR JSON_VALID(`final_results`.`answers_json`)"
        },
        "chk_final_results_metadata_json": {
          "name": "chk_final_results_metadata_json",
          "value": "`final_results`.`metadata` IS NULL OR JSON_VALID(`final_results`.`metadata`)"
        }
      }
    },
    "process_logs": {
      "name": "process_logs",
      "columns": {
        "id": {
          "name": "id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "verification_id": {
          "name": "verification_id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "step": {
          "name": "step",
          "type": "varchar(100)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "status": {
          "name": "status",
          "type": "enum('started','completed','error')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "api_response": {
          "name": "api_response",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {
        "idx_process_logs_verification_id": {
          "name": "idx_process_logs_verification_id",
          "columns": [
            "verification_id"
          ],
          "isUnique": false
        },
        "idx_process_logs_step_status": {
          "name": "idx_process_logs_step_status",
          "columns": [
            "verification_id",
            "step",
            "status"
          ],
          "isUnique": false
        },
        "idx_process_logs_created_at": {
          "name": "idx_process_logs_created_at",
          "columns": [
            "created_at"
          ],
          "isUnique": false
        },
        "idx_process_logs_status_created": {
          "name": "idx_process_logs_status_created",
          "columns": [
            "status",
            "created_at"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "process_logs_verification_id_verification_id_fk": {
          "name": "process_logs_verification_id_verification_id_fk",
          "tableFrom": "process_logs",
          "tableTo": "verification",
          "columnsFrom": [
            "verification_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {
        "process_logs_id": {
          "name": "process_logs_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {
        "chk_process_logs_error_message": {
          "name": "chk_process_logs_error_message",
          "value": "(`process_logs`.`status` = 'error' AND `process_logs`.`error_message` IS NOT NULL) OR (`process_logs`.`status` != 'error')"
        },
        "chk_process_logs_step_length": {
          "name": "chk_process_logs_step_length",
          "value": "CHAR_LENGTH(`process_logs`.`step`) >= 1 AND CHAR_LENGTH(`process_logs`.`step`) <= 100"
        },
        "chk_process_logs_api_response": {
          "name": "chk_process_logs_api_response",
          "value": "`process_logs`.`api_response` IS NULL OR JSON_VALID(`process_logs`.`api_response`)"
        }
      }
    },
    "source": {
      "name": "source",
      "columns": {
        "id": {
          "name": "id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "verification_id": {
          "name": "verification_id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "url": {
          "name": "url",
          "type": "varchar(2048)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "title": {
          "name": "title",
          "type": "varchar(500)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "summary": {
          "name": "summary",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "domain": {
          "name": "domain",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "favicon": {
          "name": "favicon",
          "type": "varchar(2048)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "is_selected": {
          "name": "is_selected",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": false
        },
        "scraping_date": {
          "name": "scraping_date",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        }
      },
      "indexes": {
        "idx_source_verification_id": {
          "name": "idx_source_verification_id",
          "columns": [
            "verification_id"
          ],
          "isUnique": false
        },
        "idx_source_domain": {
          "name": "idx_source_domain",
          "columns": [
            "domain"
          ],
          "isUnique": false
        },
        "idx_source_is_selected": {
          "name": "idx_source_is_selected",
          "columns": [
            "verification_id",
            "is_selected"
          ],
          "isUnique": false
        },
        "idx_source_created_at": {
          "name": "idx_source_created_at",
          "columns": [
            "created_at"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "source_verification_id_verification_id_fk": {
          "name": "source_verification_id_verification_id_fk",
          "tableFrom": "source",
          "tableTo": "verification",
          "columnsFrom": [
            "verification_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {
        "source_id": {
          "name": "source_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {},
      "checkConstraint": {
        "chk_source_url_length": {
          "name": "chk_source_url_length",
          "value": "CHAR_LENGTH(`source`.`url`) > 0 AND CHAR_LENGTH(`source`.`url`) <= 2048"
        }
      }
    },
    "verification": {
      "name": "verification",
      "columns": {
        "id": {
          "name": "id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "user_id": {
          "name": "user_id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "original_text": {
          "name": "original_text",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "language": {
          "name": "language",
          "type": "enum('es','eu','ca','gl')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'es'"
        },
        "status": {
          "name": "status",
          "type": "enum('draft','processing_questions','sources_ready','generating_summary','generating_image','completed','error')",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "'draft'"
        },
        "share_token": {
          "name": "share_token",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "default": "(now())"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false,
          "onUpdate": true,
          "default": "(now())"
        }
      },
      "indexes": {
        "idx_verification_user_id": {
          "name": "idx_verification_user_id",
          "columns": [
            "user_id"
          ],
          "isUnique": false
        },
        "idx_verification_status": {
          "name": "idx_verification_status",
          "columns": [
            "status"
          ],
          "isUnique": false
        },
        "idx_verification_created_at": {
          "name": "idx_verification_created_at",
          "columns": [
            "created_at"
          ],
          "isUnique": false
        },
        "idx_verification_user_status": {
          "name": "idx_verification_user_status",
          "columns": [
            "user_id",
            "status"
          ],
          "isUnique": false
        },
        "idx_verification_share_token": {
          "name": "idx_verification_share_token",
          "columns": [
            "share_token"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "verification_user_id_user_id_fk": {
          "name": "verification_user_id_user_id_fk",
          "tableFrom": "verification",
          "tableTo": "user",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {
        "verification_id": {
          "name": "verification_id",
          "columns": [
            "id"
          ]
        }
      },
      "uniqueConstraints": {
        "verification_share_token_unique": {
          "name": "verification_share_token_unique",
          "columns": [
            "share_token"
          ]
        }
      },
      "checkConstraint": {
        "chk_verification_original_text_length": {
          "name": "chk_verification_original_text_length",
          "value": "CHAR_LENGTH(`verification`.`original_text`) >= 10 AND CHAR_LENGTH(`verification`.`original_text`) <= 5000"
        }
      }
    }
  },
  "views": {},
  "_meta": {
    "schemas": {},
    "tables": {},
    "columns": {}
  },
  "internal": {
    "tables": {},
    "indexes": {}
  }
}